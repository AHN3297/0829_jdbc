package com.aclass.practice.run;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;

public class EmployeeRun {
	
	public static void main(String[] args) {
		
		Connection conn = null;
		Statement stmt = null;
		ResultSet rset =null;
		
		String sql = """
					SELECT
					       EMP_ID
					     , EMP_NAME
					     , EMP_NO
					     , EMAIL
					     , PHONE
					     , DEPT_CODE
					     , JOB_CODE
					     , SALLEVEL
					     , SALARY
					     , BONUS
					     , MANAGER_ID
					     , HIRE_DATE
					     , ENT_DATE
					     , ENT_YN
					  FROM
					       EMPLOYEE
					 ORDER
					    BY
					       EMP_ID
				""";
		try {
			Class.forName("oracle.jdbc.driver.OracleDriver");
			conn = DriverManager.getConnection("jdbc:oracle:thin:@115.90.212.20:10000:XE"
												,"AYS14"
												,"AYS141234");
			System.out.println("DB서버접속 성공");
			
			stmt = conn.createStatement();
			rset = stmt.executeQuery(sql);
			
			while(rset.next()) {
				int employeeId = rset.getInt("EMP_ID");
				String name = rset.getString("EMP_NAME");
				String emno = rset.getString("EMP_NO");
				String email = rset.getString("EMAIL");
				String phone = rset.getString("PHONE");
				String dc = rset.getString("DEPT_CODE");
				String jc = rset.getString("JOB_CODE");
				String sl = rset.getString("SALLEVEL");
				int salary = rset.getInt("SALARY");	
				System.out.println("사원번호 : " + name);
			}
			stmt.executeQuery(sql);
		}catch(ClassNotFoundException e){
			System.out.println("ojdbc추가했나요");
			System.out.println("oracle.jdbc.driver.OracleDriver오타없나요");
		}catch(SQLException e){
			e.printStackTrace();
			System.out.println("jdbc:oracle:thin:@115.90.212.20:10000:XE오타없나요");
			System.out.println("사용자계정명 / 비밀번호가 올바른가요?");
		} finally {
			try {
				if(rset != null && !rset.isClosed()){
					rset.close();
				}
			}catch(SQLException e) {
				e.printStackTrace();
			}
			try {
				if(stmt!= null && !stmt.isClosed()) {
					stmt.close();
				}
			}catch(SQLException e) {
				e.printStackTrace();
			}
			try {
				if(conn != null && !conn.isClosed()) {
					conn.close();
				}
			}catch(SQLException e) {
				e.printStackTrace();
			}
		}
			
		
	}

}
